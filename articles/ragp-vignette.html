<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to ragp • ragp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ragp">
<meta property="og:description" content="ragp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ragp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pkgdown/start.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pkgdown/filter.html">Filtering hydroxyproline rich glycoproteins</a>
    </li>
    <li>
      <a href="../articles/pkgdown/analyse.html">Analyse hydroxyproline rich glycoproteins</a>
    </li>
    <li>
      <a href="../articles/pkgdown/PSV.html">Protein Sequence Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://ragp.shinyapps.io/Rapp/">ragp shiny</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/missuse/ragp/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ragp-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to ragp</h1>
                        <h4 class="author">Milan Dragićević</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/missuse/ragp/blob/master/vignettes/ragp-vignette.Rmd"><code>vignettes/ragp-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>ragp-vignette.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      This vignette provides an introduction into the functions and workflow in <code>ragp</code> R package. <code>ragp</code> is designed for mining and analysis of plant Hydroxyproline rich glycoproteins but it can also be used for protein annotation and for obtaining predictions for several protein features based on sequence (secretory signals, transmembrane regions, domains and glycosylphosphatidylinositol attachment sites). Additionally <code>ragp</code> provides tools for visualization of the mentioned attributes.
    </div>
    
<div id="what-is-ragp" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-ragp" class="anchor"></a>What is ragp?</h1>
<p>Hydroxyproline rich glycoproteins (HRGPs) are one of the most complex families of macromolecules found in plants, due to the diversity of glycans decorating the protein backbone, as well as the heterogeneity of the protein backbones. While this diversity is responsible for the wide array of physiological functions associated with HRGPs, it hinders attempts for homology based identification. Current approaches, based on identifying sequences with characteristic motifs and biased amino acid composition, are limited to prototypical sequences.</p>
<p><code>ragp</code> is an R package for mining and analyses of HRGPs, with emphasis on arabinogalactan protein sequences (AGPs). The <code>ragp</code> filtering pipeline exploits one of the HRGPs key features, the presence of hydroxyprolines which represent glycosylation sites. Main package features include prediction of proline hydroxylation sites, amino acid motif and bias analyses, efficient communication with web servers for prediction of N-terminal signal peptides and glycosylphosphatidylinositol modification sites, as well as the ability to annotate sequences through <a href="https://www.ncbi.nlm.nih.gov/Structure/bwrpsb/bwrpsb.cgi">CDD</a> or <a href="https://www.ebi.ac.uk/Tools/hmmer/search/hmmscan">hmmscan</a> and subsequent <a href="http://www.geneontology.org/">GO</a> enrichment, based on predicted <a href="https://pfam.xfam.org/">Pfam</a> domains.</p>
<p>The workflow in <code>ragp</code> is illustrated with the following diagram (<code>ragp</code> functions to be used for each of the tasks are boxed grey):</p>
<p><img src="ragp_flow_chart.svg" width="60%" style="display: block; margin: auto;"></p>
<p>The filtering layer:</p>
<ul>
<li>predict the presence of secretory signals (N-sp) and filter sequences containing them. Several prediction algorithms are available. Currently recommended is to use <code><a href="../reference/get_signalp5.html">get_signalp5()</a></code> which queries <a href="https://services.healthtech.dtu.dk/service.php?SignalP-5.0">SignalP5</a> <span class="citation">(Almagro Armenteros et al. 2019)</span>.<br>
</li>
<li>predict proline hydroxylation (<code><a href="../reference/predict_hyp.html">predict_hyp()</a></code>) and filter sequences containing several (for example three or more) potential hydroxyprolines.</li>
</ul>
<p>The analysis layer:</p>
<ul>
<li>find localized clusters of characteristic arabinogalactan motifs (AG glycomodules) to identify potential AGPs (<code><a href="../reference/scan_ag.html">scan_ag()</a></code>) among the hydroxyproline containing sequences.</li>
<li>perform motif and amino acid bias (MAAB, <span class="citation">(Johnson et al. 2017)</span>) classification scheme (<code><a href="../reference/maab.html">maab()</a></code>) to classify hydroxyproline containing sequences.</li>
<li>annotate domains using <a href="https://pfam.xfam.org/">Pfam</a> (<code><a href="../reference/get_hmm.html">get_hmm()</a></code>) and enrich with gene ontology (GO) terms (<code><a href="../reference/pfam2go.html">pfam2go()</a></code>). Alternatively annotate domains using <a href="https://www.ncbi.nlm.nih.gov/Structure/bwrpsb/bwrpsb.cgi">CDD</a>.<br>
</li>
<li>predict the presence of potential glycosylphosphatidylinositol attachment sites (<code><a href="../reference/get_big_pi.html">get_big_pi()</a></code>, <code><a href="../reference/get_pred_gpi.html">get_pred_gpi()</a></code> and <code><a href="../reference/get_netGPI.html">get_netGPI()</a></code>).<br>
</li>
<li>predict disordered regions in proteins (<code><a href="../reference/get_espritz.html">get_espritz()</a></code>).</li>
<li>predict transmembrane regions in proteins (<code><a href="../reference/get_phobius.html">get_phobius()</a></code> and <code><a href="../reference/get_tmhmm.html">get_tmhmm()</a></code>)</li>
</ul>
<p>Additionally <code>ragp</code> provides tools for visualization of the mentioned attributes via <code><a href="../reference/plot_prot.html">plot_prot()</a></code>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>There are several ways to install R packages hosted on git-hub, however the simplest is to use <code>devtools::install_github()</code> which will perform all the required steps automatically.</p>
<p>To install <code>ragp</code> run:</p>
<pre class="text"><code>#install.packages("devtools") #if it is not installed on your system
devtools::install_github("missuse/ragp")</code></pre>
<p>alternatively run:</p>
<pre class="text"><code># install.packages("devtools")
devtools::install_github("missuse/ragp",
                         build_vignettes = TRUE)</code></pre>
<p>to build vignettes which can be viewed by:</p>
<pre class="text"><code><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes("ragp")</a></code></pre>
</div>
</div>
<div id="data-import" class="section level1">
<h1 class="hasAnchor">
<a href="#data-import" class="anchor"></a>Data import</h1>
<div id="inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs" class="anchor"></a>Inputs</h2>
<p>Most <code>ragp</code> functions require single letter protein sequences and the corresponding identifiers as input. These can be provided in the form of basic <code>R</code> data types such as vectors or data frames. Additionally <code>ragp</code> imports the <a href="https://cran.r-project.org/web/packages/seqinr/index.html"><code>seqinr</code></a> package for the manipulation of <code>.FASTA</code> files, so the input objects can be a list of <a href="https://search.r-project.org/CRAN/refmans/seqinr/html/SeqFastaAA.html"><code>SeqFastaAA</code></a> objects returned by the <code><a href="https://rdrr.io/pkg/seqinr/man/read.fasta.html">seqinr::read.fasta()</a></code>. The location of a <code>.FASTA</code> file is also possible as a type of input. As of ragp version 0.3.5 objects of class <a href="https://web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/Biostrings/html/XStringSet-class.html"><code>AAStringSet</code></a> are also supported.</p>
<p>Input options will be illustrated using <code><a href="../reference/scan_ag.html">scan_ag()</a></code> function:</p>
<ul>
<li>provide a <code>character</code> vector of protein sequences to the <code>sequence</code> argument and a <code>character</code> vector of protein identifiers to the <code>id</code> argument:</li>
</ul>
<pre class="text"><code><a href="https://github.com/missuse/ragp">library(ragp)
data(at_nsp) #a data frame of 2700 Arabidopsis sequences
input1 &lt;- scan_ag(sequence = at_nsp$sequence,
                  id = at_nsp$Transcript.id) </a></code></pre>
<ul>
<li>provide a <code>data.frame</code> to <code>data</code> argument, and names of columns containing the protein sequences and corresponding identifiers to <code>sequence</code> and <code>id</code> arguments:</li>
</ul>
<pre class="text"><code>input2 &lt;- scan_ag(data = at_nsp,
                  sequence = "sequence",
                  id = "Transcript.id") </code></pre>
<p>quoting column names is not necessary:</p>
<pre class="text"><code>input3 &lt;- scan_ag(data = at_nsp,
                  sequence = sequence,
                  id = Transcript.id) </code></pre>
<ul>
<li>provide a list of <code>SeqFastaAA</code> objects to <code>data</code> argument:</li>
</ul>
<pre class="text"><code><a href="http://seqinr.r-forge.r-project.org/">library(seqinr) #to create a fasta file with protein sequences

#write a FASTA file
seqinr::write.fasta(sequence = strsplit(at_nsp$sequence, ""),
                    name = at_nsp$Transcript.id, file = "at_nsp.fasta")

#read a FASTA file to a list of SeqFastaAA objects
At_seq_fas &lt;- read.fasta("at_nsp.fasta",
                         seqtype =  "AA", 
                         as.string = TRUE) 

input4 &lt;- scan_ag(data = At_seq_fas) </a></code></pre>
<ul>
<li>provide the location of a <code>.FASTA</code> file to be analyzed as string:</li>
</ul>
<pre class="text"><code>input5 &lt;- scan_ag(data = "at_nsp.fasta") #file at_nsp.fasta is in the working directory</code></pre>
<ul>
<li>provide an <a href="https://web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/Biostrings/html/XStringSet-class.html"><code>AAStringSet</code></a> object:</li>
</ul>
<pre class="text"><code>dat &lt;- Biostrings::readAAStringSet("at_nsp.fasta") #file at_nsp.fasta is in the working directory
input6 &lt;- scan_ag(data = dat) </code></pre>
<p>All of the outputs are equal:</p>
<pre class="text"><code><a href="https://rdrr.io/r/base/all.equal.html">all.equal(input1,
          input2)
#&gt; [1] TRUE</a></code></pre>
<pre class="text"><code><a href="https://rdrr.io/r/base/all.equal.html">
all.equal(input1,
          input3)
#&gt; [1] TRUE</a></code></pre>
<pre class="text"><code><a href="https://rdrr.io/r/base/all.equal.html">
all.equal(input1,
          input4)
#&gt; [1] TRUE</a></code></pre>
<pre class="text"><code><a href="https://rdrr.io/r/base/all.equal.html">
all.equal(input1,
          input5)
#&gt; [1] TRUE</a></code></pre>
<pre class="text"><code><a href="https://rdrr.io/r/base/all.equal.html">
all.equal(input1,
          input6)
#&gt; [1] TRUE</a></code></pre>
<p>The only exceptions to this design are the plotting function <code><a href="../reference/plot_prot.html">plot_prot()</a></code> which requires protein sequences to be supplied in the form of string vectors (input1 in the above example) and <code><a href="../reference/pfam2go.html">pfam2go()</a></code> which does not take sequences as input.</p>
</div>
</div>
<div id="further-reading" class="section level1">
<h1 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further reading</h1>
<p>All <code>ragp</code> functions return basic R data structures such as data frames, lists of vectors and lists of data frames, making them convenient for manipulation to anyone familiar with R. An especially effective way to manipulate these objects is by utilizing the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> collection of packages, especially <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> and <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>. Several <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> functions that will be especially handy for data wrangling are:</p>
<ul>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">dplyr::left_join()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::group_by()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">dplyr::summarise()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">dplyr::distinct()</a></code></li>
</ul>
<p>Examples on usage of these functions on objects returned by <code>ragp</code> functions are provided in <a href="https://missuse.github.io/ragp/articles/pkgdown/filter">HRGP filtering</a> and <a href="https://missuse.github.io/ragp/articles/pkgdown/analyse">HRGP analysis</a> tutorials. Additionally there are extensive examples on the internet on usage of the mentioned functions.</p>
<p>Obtaining pretty visualizations is usually the goal of the above mentioned data manipulations. The golden standard of R graphics at present is the <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package and we recommend it to graphically summarize the data. Additionally <code>ragp</code> contains <code><a href="../reference/plot_prot.html">plot_prot()</a></code> function which is a wrapper for <code>ggplot2</code>, and while <code><a href="../reference/plot_prot.html">plot_prot()</a></code> can be used without knowing <code>ggplot2</code> syntax, to tweak the plot style at least a basic knowledge of <code>ggplot2</code> is required. Examples are provided in <a href="https://missuse.github.io/ragp/articles/pkgdown/PSV">protein sequence visualization</a> tutorial.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>This software was developed with funding from the Ministry of Education, Science and Technological Development of the Republic of Serbia (Projects TR31019 and OI173024).</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-armenteros_signalp5_2019">
<p>Almagro Armenteros, José Juan, Konstantinos D. Tsirigos, Casper Kaae Sønderby, Thomas Nordahl Petersen, Ole Winther, Søren Brunak, Gunnar von Heijne, and Henrik Nielsen. 2019. “SignalP 5.0 Improves Signal Peptide Predictions Using Deep Neural Networks.” <em>Nature Biotechnology</em> 37: 420–23. <a href="https://doi.org/0.1038/s41587-019-0036-z">https://doi.org/0.1038/s41587-019-0036-z</a>.</p>
</div>
<div id="ref-johnson_pipeline_2017">
<p>Johnson, Kim L., Andrew M. Cassin, Andrew Lonsdale, Antony Bacic, Monika S. Doblin, and Carolyn J. Schultz. 2017. “Pipeline to Identify Hydroxyproline-Rich Glycoproteins.” <em>Plant Physiology</em> 174 (2): 886–903. <a href="https://doi.org/10.1104/pp.17.00294">https://doi.org/10.1104/pp.17.00294</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Milan Dragicevic, Danijela Paunovic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
